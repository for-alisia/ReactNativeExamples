{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/alisia/Projects/ReactNative/shop/screens/shop/CartScreen.jsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { useSelector, useDispatch } from 'react-redux';\nimport { SbText, SbTitle, SbLink, SbHeading, SbBottomButton } from \"../../components/ui\";\nimport { CartItem } from \"../../components/shop\";\nimport theme from \"../../theme\";\nimport { cartActions } from \"../../store/cart.slice\";\nimport { addOrder } from \"../../store/orders.slice\";\nimport { getTotalPositions } from \"../../utils\";\n\nvar CartScreen = function CartScreen(_ref) {\n  var navigation = _ref.navigation;\n  var cartTotal = useSelector(function (state) {\n    return state.cart.total;\n  });\n  var cartItems = useSelector(function (state) {\n    var transformedItems = [];\n\n    for (var key in state.cart.items) {\n      transformedItems.push(_objectSpread({\n        id: key\n      }, state.cart.items[key]));\n    }\n\n    return transformedItems;\n  });\n  var isLoadingOrder = useSelector(function (state) {\n    return state.orders.isLoading;\n  });\n  var isAddingOrderSuccess = useSelector(function (state) {\n    return state.orders.isSuccessed;\n  });\n  var error = useSelector(function (state) {\n    return state.orders.error;\n  });\n  var dispatch = useDispatch();\n\n  var itemDeleteFromCartHandler = function itemDeleteFromCartHandler(id) {\n    dispatch(cartActions.deleteFromCart(id));\n  };\n\n  var itemAddInCartHandler = function itemAddInCartHandler(id) {\n    dispatch(cartActions.increaseInCart(id));\n  };\n\n  var itemSubstractInCartHandler = function itemSubstractInCartHandler(id) {\n    dispatch(cartActions.substractFromCart(id));\n  };\n\n  var addNewOrderHandler = function addNewOrderHandler() {\n    dispatch(addOrder({\n      items: cartItems,\n      total: cartTotal\n    }));\n  };\n\n  useEffect(function () {\n    if (error) {\n      Alert.alert('Произошла ошибка', 'При размещении заказа произошла ошибка', [{\n        text: 'OK'\n      }]);\n      return;\n    }\n\n    if (!error && isAddingOrderSuccess) {\n      dispatch(cartActions.clearCart());\n    }\n  }, [error, isAddingOrderSuccess]);\n\n  var renderItem = function renderItem(itemData) {\n    var item = itemData.item;\n\n    var viewDetailHandler = function viewDetailHandler() {\n      navigation.navigate('ProductDetail', {\n        productId: item.id,\n        productTitle: item.title\n      });\n    };\n\n    return React.createElement(CartItem, {\n      item: item,\n      onViewDetail: viewDetailHandler,\n      onDeleteItem: itemDeleteFromCartHandler.bind(null, item.id),\n      onAddItem: itemAddInCartHandler.bind(null, item.id),\n      onSubstractItem: itemSubstractInCartHandler.bind(null, item.id),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 7\n      }\n    });\n  };\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 5\n    }\n  }, cartTotal > 0 ? React.createElement(View, {\n    style: styles.detailsContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: styles.innerContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 11\n    }\n  }, React.createElement(SbHeading, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }\n  }, \"\\u0414\\u0435\\u0442\\u0430\\u043B\\u0438 \\u0437\\u0430\\u043A\\u0430\\u0437\\u0430\"), React.createElement(View, {\n    style: styles.summary,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }\n  }, React.createElement(View, {\n    style: styles.summaryRow,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 15\n    }\n  }, React.createElement(View, {\n    style: styles.colLarge,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 17\n    }\n  }, React.createElement(SbText, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 19\n    }\n  }, \"\\u0412\\u0441\\u0435\\u0433\\u043E \\u043F\\u043E\\u0437\\u0438\\u0446\\u0438\\u0439 \\u0432 \\u0437\\u0430\\u043A\\u0430\\u0437\\u0435:\")), React.createElement(View, {\n    style: styles.colNarrow,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 17\n    }\n  }, React.createElement(SbTitle, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 19\n    }\n  }, getTotalPositions(cartItems)))), React.createElement(View, {\n    style: styles.summaryRow,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 15\n    }\n  }, React.createElement(View, {\n    style: styles.colLarge,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 17\n    }\n  }, React.createElement(SbText, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 19\n    }\n  }, \"\\u041D\\u0430 \\u0441\\u0443\\u043C\\u043C\\u0443:\")), React.createElement(View, {\n    style: styles.colNarrow,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 17\n    }\n  }, React.createElement(SbTitle, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 19\n    }\n  }, cartTotal.toFixed(2), \" \\u0440\\u0443\\u0431.\")))), React.createElement(View, {\n    style: {\n      paddingBottom: 280\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }\n  }, React.createElement(FlatList, {\n    numColumns: 1,\n    data: cartItems,\n    renderItem: renderItem,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 15\n    }\n  }))), React.createElement(SbBottomButton, {\n    onPress: addNewOrderHandler,\n    disabled: cartTotal > 0 ? false : true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 11\n    }\n  }, React.createElement(SbTitle, {\n    style: styles.confirmOredertext,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }\n  }, \"\\u041E\\u0444\\u043E\\u0440\\u043C\\u0438\\u0442\\u044C \\u0437\\u0430\\u043A\\u0430\\u0437\"))) : React.createElement(View, {\n    style: styles.emptyContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 9\n    }\n  }, React.createElement(SbText, {\n    style: styles.emptyCartText,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 11\n    }\n  }, \"\\u0412\\u0430\\u0448\\u0430 \\u043A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430 \\u043F\\u043E\\u043A\\u0430 \\u043F\\u0443\\u0441\\u0442\\u0430\"), React.createElement(SbLink, {\n    onPress: function onPress() {\n      navigation.navigate('ProductsOverview');\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 11\n    }\n  }, \"\\u041D\\u0430\\u0447\\u043D\\u0438\\u0442\\u0435 \\u043F\\u043E\\u043A\\u0443\\u043F\\u043A\\u0438!\")));\n};\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  detailsContainer: {\n    flex: 1\n  },\n  innerContainer: {\n    padding: theme.padding.s\n  },\n  confirmOredertext: {\n    color: theme.colors.light,\n    textTransform: 'uppercase',\n    fontFamily: theme.fonts.montserratReg\n  },\n  emptyContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginTop: -64\n  },\n  summary: {\n    marginBottom: theme.margin.s\n  },\n  summaryRow: {\n    marginBottom: theme.margin.s,\n    flexDirection: 'row',\n    justifyContent: 'space-between'\n  },\n  colLarge: {\n    width: '60%'\n  },\n  colNarrow: {\n    width: '40%',\n    paddingLeft: theme.padding.s\n  },\n  emptyCartText: {\n    textAlign: 'center',\n    marginBottom: theme.margin.m\n  }\n});\n\nCartScreen.navigationOptions = function (navData) {\n  return {\n    headerTitle: 'Корзина'\n  };\n};\n\nexport default CartScreen;","map":{"version":3,"sources":["/Users/alisia/Projects/ReactNative/shop/screens/shop/CartScreen.jsx"],"names":["React","useEffect","useSelector","useDispatch","SbText","SbTitle","SbLink","SbHeading","SbBottomButton","CartItem","theme","cartActions","addOrder","getTotalPositions","CartScreen","navigation","cartTotal","state","cart","total","cartItems","transformedItems","key","items","push","id","isLoadingOrder","orders","isLoading","isAddingOrderSuccess","isSuccessed","error","dispatch","itemDeleteFromCartHandler","deleteFromCart","itemAddInCartHandler","increaseInCart","itemSubstractInCartHandler","substractFromCart","addNewOrderHandler","Alert","alert","text","clearCart","renderItem","itemData","item","viewDetailHandler","navigate","productId","productTitle","title","bind","styles","container","detailsContainer","innerContainer","summary","summaryRow","colLarge","colNarrow","toFixed","paddingBottom","confirmOredertext","emptyContainer","emptyCartText","StyleSheet","create","flex","padding","s","color","colors","light","textTransform","fontFamily","fonts","montserratReg","justifyContent","alignItems","marginTop","marginBottom","margin","flexDirection","width","paddingLeft","textAlign","m","navigationOptions","navData","headerTitle"],"mappings":"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","sourcesContent":["// @ts-nocheck\nimport React, { useEffect } from 'react';\nimport { View, StyleSheet, FlatList, Alert } from 'react-native';\nimport { useSelector, useDispatch } from 'react-redux';\n\n// Components\nimport { SbText, SbTitle, SbLink, SbHeading, SbBottomButton } from '../../components/ui';\nimport { CartItem } from '../../components/shop';\n\n// Theme\nimport theme from '../../theme';\n\n// Actions\nimport { cartActions } from '../../store/cart.slice';\nimport { addOrder } from '../../store/orders.slice';\n\n// Utils\nimport { getTotalPositions } from '../../utils';\n\nconst CartScreen = ({ navigation }) => {\n  // @ts-ignore\n  const cartTotal = useSelector((state) => state.cart.total);\n  const cartItems = useSelector((state) => {\n    const transformedItems = [];\n\n    // @ts-ignore\n    for (let key in state.cart.items) {\n      transformedItems.push({\n        id: key,\n        // @ts-ignore\n        ...state.cart.items[key],\n      });\n    }\n\n    return transformedItems;\n  });\n  const isLoadingOrder = useSelector((state) => state.orders.isLoading);\n  const isAddingOrderSuccess = useSelector((state) => state.orders.isSuccessed);\n  const error = useSelector((state) => state.orders.error);\n\n  const dispatch = useDispatch();\n\n  // Deleting item from cart\n  const itemDeleteFromCartHandler = (id) => {\n    dispatch(cartActions.deleteFromCart(id));\n  };\n  // Adding item in the cart\n  const itemAddInCartHandler = (id) => {\n    dispatch(cartActions.increaseInCart(id));\n  };\n  // Substracting item in the cart\n  const itemSubstractInCartHandler = (id) => {\n    dispatch(cartActions.substractFromCart(id));\n  };\n  // Create new Order\n  const addNewOrderHandler = () => {\n    dispatch(addOrder({ items: cartItems, total: cartTotal }));\n  };\n\n  useEffect(() => {\n    if (error) {\n      Alert.alert('Произошла ошибка', 'При размещении заказа произошла ошибка', [{ text: 'OK' }]);\n      return;\n    }\n    if (!error && isAddingOrderSuccess) {\n      dispatch(cartActions.clearCart());\n    }\n  }, [error, isAddingOrderSuccess]);\n  // Render item in a list\n  const renderItem = (itemData) => {\n    const { item } = itemData;\n\n    const viewDetailHandler = () => {\n      navigation.navigate('ProductDetail', { productId: item.id, productTitle: item.title });\n    };\n\n    return (\n      <CartItem\n        item={item}\n        onViewDetail={viewDetailHandler}\n        onDeleteItem={itemDeleteFromCartHandler.bind(null, item.id)}\n        onAddItem={itemAddInCartHandler.bind(null, item.id)}\n        onSubstractItem={itemSubstractInCartHandler.bind(null, item.id)}\n      />\n    );\n  };\n\n  return (\n    <View style={styles.container}>\n      {cartTotal > 0 ? (\n        <View style={styles.detailsContainer}>\n          <View style={styles.innerContainer}>\n            <SbHeading>Детали заказа</SbHeading>\n            <View style={styles.summary}>\n              <View style={styles.summaryRow}>\n                <View style={styles.colLarge}>\n                  <SbText>Всего позиций в заказе:</SbText>\n                </View>\n                <View style={styles.colNarrow}>\n                  <SbTitle>{getTotalPositions(cartItems)}</SbTitle>\n                </View>\n              </View>\n              <View style={styles.summaryRow}>\n                <View style={styles.colLarge}>\n                  <SbText>На сумму:</SbText>\n                </View>\n                <View style={styles.colNarrow}>\n                  <SbTitle>{cartTotal.toFixed(2)} руб.</SbTitle>\n                </View>\n              </View>\n            </View>\n            <View style={{ paddingBottom: 280 }}>\n              <FlatList numColumns={1} data={cartItems} renderItem={renderItem} />\n            </View>\n          </View>\n          <SbBottomButton onPress={addNewOrderHandler} disabled={cartTotal > 0 ? false : true}>\n            <SbTitle style={styles.confirmOredertext}>Оформить заказ</SbTitle>\n          </SbBottomButton>\n        </View>\n      ) : (\n        <View style={styles.emptyContainer}>\n          <SbText style={styles.emptyCartText}>Ваша корзина пока пуста</SbText>\n          <SbLink\n            onPress={() => {\n              navigation.navigate('ProductsOverview');\n            }}\n          >\n            Начните покупки!\n          </SbLink>\n        </View>\n      )}\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  detailsContainer: {\n    flex: 1,\n  },\n  innerContainer: {\n    padding: theme.padding.s,\n  },\n  confirmOredertext: {\n    color: theme.colors.light,\n    textTransform: 'uppercase',\n    fontFamily: theme.fonts.montserratReg,\n  },\n\n  emptyContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginTop: -64,\n  },\n  summary: {\n    marginBottom: theme.margin.s,\n  },\n  summaryRow: {\n    marginBottom: theme.margin.s,\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n  },\n  colLarge: {\n    width: '60%',\n  },\n  colNarrow: {\n    width: '40%',\n    paddingLeft: theme.padding.s,\n  },\n  emptyCartText: {\n    textAlign: 'center',\n    marginBottom: theme.margin.m,\n  },\n});\n\nCartScreen.navigationOptions = (navData) => ({\n  headerTitle: 'Корзина',\n});\n\nexport default CartScreen;\n"]},"metadata":{},"sourceType":"module"}